---
title: "forecast::Arima Models"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{forecast::Arima Models}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette is intended to show the current ability to parse objects generated by `forecast::Arima` by {equatiomatic}. The output uses notation from [Hyndman](https://robjhyndman.com/hyndsight/arimaconstants/#:~:text=By%20default%2C%20the%20arima(),intercept%E2%80%9D%20in%20the%20R%20output) with the exception of $a$ and $b$ for intercept and drift respectfully being replace by $\mu$ and $delta$. To improve readability and reduce formula size, Arima functions are presented in Backshift (sometimes called Lag) notation. `forecast::Arima` will automatically generate either an Arima model or linear regression with Arima errors. We'll address both with an example below.

## Basic Examples
### ARIMA without Exogenous Regressors
#### Setup

First we need to generate a model. It isn't important the the model is appropriate, but rather that it shows how the equations are parsed.

```{r setup_arima}
  # Set seed so that rnorm returns the same result
  set.seed(123)
  
  # Build Arima (no regression)
model <- forecast::Arima(ts(rnorm(1000),freq=4), 
                         order=c(1,1,1),
                         seasonal=c(1,0,1),
                         include.constant = TRUE)
```

#### Extracting the equation
```{r extract_arima}
eq <- equatiomatic::extract_eq(model)
```

#### Kniting the equation
```{r knit_arima, results='asis'}
eq
```

### Regression with ARIMA Errors
#### Setup
```{r setup_arima_errors}
  # Set seed so that rnorm returns the same result
  set.seed(123)
  
  # Build Exogenous Regressors
  xregs <- as.matrix(data.frame(x1 = rnorm(1000) + 5,
                                x2 = rnorm(1000) * 5))
  
  # Build Regression Model
  model <- forecast::Arima(ts(rnorm(1000),freq=4), 
                           order=c(1,1,1),
                           seasonal=c(1,0,1),
                           xreg = xregs,
                           include.constant = TRUE)
```

#### Extracting the equation
```{r extract_arima_errors}
eq <- equatiomatic::extract_eq(model)
```

#### Kniting the equation
```{r knit_arima_errors, results='asis'}
eq
```


## Working with other parts of {equatiomatic}

While still in development, the other functionalities of `extract_eq` for `lm` objects should generally work for `forecast::Arima` objects as well (e.g. interaction terms). Please let us know (preferably with a reproducible example) if you run into any issues.

## Future Development

Development items on the docket include:

* Testing additional functionality from `extract_eq` for `lm` objects.
* Implementation of arguments that will allow the user to rename variables and/or specify a set of greek letters.
* If there is interest, the ability to switch to an expanded version of the equation. This could generate extremely long and difficult to read equations.

This is the first of (hopefully) most of the models in `forecast` being implemented in {equatiomatic}. `Arima` is one of the most used modelling techniques for time-series and, as such, got first treatment. There's a lot we can do from here and I'm happy for any help or feedback from the community.
